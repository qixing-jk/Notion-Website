console.log("\n %c Post-Abstract-AI-NotionNex \u5F00\u6E90\u535A\u5BA2\u6587\u7AE0\u6458\u8981AI\u751F\u6210\u5DE5\u5177 %c https://github.com/PastKing/Post-Abstract-AI-NotionNext \n","color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;");function ChucklePostAI(a){function b(a){c();const b=document.querySelector(a);if(b){const a=document.createElement("div");a.className="post-ai",a.innerHTML=`
      <div class="ai-container">
        <div class="ai-header">
          <div class="ai-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
              <path fill="#ffffff" d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8Z" />
            </svg>
          </div>
          <div class="ai-title">AI智能摘要</div>
          <div class="ai-tag">GPT</div>
        </div>
        <div class="ai-content">
          <div class="ai-explanation">生成中...<span class="blinking-cursor"></span></div>
        </div>
      </div>
    `,b.insertBefore(a,b.firstChild)}}function c(){const a=document.querySelector(".post-ai");a&&a.parentElement.removeChild(a)}function d(){return document.querySelector("#article-wrapper #notion-article")}function e(){if(f()){const a=d();if(a){b("#"+a.id);const c=h.getTitleAndContent();c&&console.log("ChucklePostAI\u672C\u6B21\u63D0\u4EA4\u7684\u5185\u5BB9\u4E3A\uFF1A"+c),h.fetchAISummary(c).then(a=>{h.aiShowAnimation(a)})}else console.warn("ChucklePostAI\uFF1A\u65E0\u6CD5\u627E\u5230\u4E3B\u6587\u7AE0\u5BB9\u5668")}}function f(){return["posts","article"].some(a=>window.location.pathname.includes(a))}var g=!1,h={getTitleAndContent:function(){try{const b=document.title,c=d();if(!c)return console.warn("ChucklePostAI\uFF1A\u627E\u4E0D\u5230\u4E3B\u6587\u7AE0\u5BB9\u5668\u3002"),"";const e=c.getElementsByTagName("p"),f=c.querySelectorAll("h1, h2, h3, h4, h5");let g="";for(let a of f)g+=a.innerText+" ";for(let a of e){const b=a.innerText.replace(/https?:\/\/[^\s]+/g,"");g+=b}const h=b+" "+g;let i=a.wordLimit||1e3;const j=h.slice(0,i);return j}catch(a){return console.error("ChucklePostAI\u9519\u8BEF\uFF1A\u83B7\u53D6\u6587\u7AE0\u5185\u5BB9\u5931\u8D25",a),""}},fetchAISummary:async function(a){try{const b=await fetch("https://summary.qixing1217.top/api/summary?token=57X8Ht6R9a8GX548ggS",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:a})});if(b.ok){const a=await b.json();return a.summary}throw new Error("Response not ok")}catch(a){return console.error("ChucklePostAI\uFF1A\u8BF7\u6C42\u5931\u8D25",a),"\u83B7\u53D6\u6587\u7AE0\u6458\u8981\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\u3002"}},aiShowAnimation:function(a){const b=document.querySelector(".ai-explanation");if(!b)return;if(g)return;g=!0;const c=25;b.innerHTML="\u751F\u6210\u4E2D...<span class=\"blinking-cursor\"></span>";let d=!0,e=0,f=performance.now();const h=()=>{if(e<a.length&&d){const d=performance.now(),j=d-f,k=a.slice(e,e+1),l=/[，。！、？,.!?]/.test(k),m=l?c*6:c;j>=m&&(b.innerText=a.slice(0,e+1),f=d,e++,e<a.length?b.innerHTML=a.slice(0,e)+"<span class=\"blinking-cursor\"></span>":(b.innerHTML=a,g=!1,i.disconnect())),requestAnimationFrame(h)}},i=new IntersectionObserver(a=>{let b=a[0].isIntersecting;d=b,d&&0===e&&setTimeout(()=>{requestAnimationFrame(h)},200)},{threshold:0});let j=document.querySelector(".post-ai");i.observe(j)}};f()&&function(){a.pjax?(e(),document.addEventListener("pjax:complete",e)):e()}();let i=new URL(location.href).pathname+new URL(location.href).search;new MutationObserver(()=>{const a=new URL(location.href).pathname+new URL(location.href).search;a!==i&&(i=a,f()&&location.reload())}).observe(document,{subtree:!0,childList:!0})}ChucklePostAI({pjax:!0,wordLimit:1e3});